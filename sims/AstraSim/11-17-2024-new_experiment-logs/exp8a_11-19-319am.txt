[0mVERSION:  2
astrasim_220_example/knobs_8.py
astrasim_220_example/network_input_8.yml
astrasim_220_example/system_input_8.json
astrasim_220_example/workload_cfg_8_gpt3_175b.json
[DEBUG][Seed] 12234
[DEBUG][RL Form] random_walker
[DEBUG][Max Steps] 50000
[DEBUG][Num Agents] 1
[DEBUG][Reward Formulation] runtime*cost
[DEBUG][Reward Scaling] false
ENV - self.workload_files:  ['/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_8_gpt3_175b.json']
self.param_len:  0
system knobs:  {}
self.param_len:  0
network knobs:  {'topology': ({'FullyConnected', 'Switch', 'Ring'}, 'FALSE'), 'npus-count': ({8, 16, 4}, 'FALSE')}
self.param_len:  8
workload knobs:  {'dp': ({32, 1, 2, 64, 4, 128, 256, 512, 8, 16}, 'N/A'), 'pp': ({1, 2, 4}, 'N/A'), 'sp': ({32, 1, 2, 64, 4, 128, 256, 512, 8, 16}, 'N/A'), 'weight_sharded': ((0, 1, 1), 'N/A')}
dimensions:  4
param_len:  12
_____________________*****************************_____________________
CONSTRAINTS:  ['product network npus-count == num workload num_npus', 'mult workload dp workload sp workload pp <= num workload num_npus']
DERIVED KNOBS:  ['network bandwidth', 'system all-reduce-implementation', 'system all-gather-implementation', 'system reduce-scatter-implementation', 'system all-to-all-implementation']
DIMENSION:  4
0 0 DIMENSION:  4
DIMENSION:  4
0 1 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 2, 'sp': 64, 'weight_sharded': 1}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 2, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 6.666666666666667, 100, 50]
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [16, 16, 16, 16], 'bandwidth': [100, 6.666666666666667, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 2, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  65536 == 1024
constraint not satisfied
DIMENSION:  4
0 2 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 1, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 1, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 50, 100]
system knob:  ['ring', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['ring', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['ring', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['ring', 'halvingDoubling', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Switch'], 'npus-count': [16, 4, 8, 8], 'bandwidth': [50, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 1, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 3 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 2, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 2, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 6.666666666666667, 50, 50]
system knob:  ['direct', 'direct', 'ring', 'ring']
system knob:  ['direct', 'direct', 'ring', 'ring']
system knob:  ['direct', 'direct', 'ring', 'ring']
system knob:  ['direct', 'direct', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [33.333333333333336, 6.666666666666667, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 2, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 4 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 50, 50, 50]
system knob:  ['direct', 'ring', 'ring', 'ring']
system knob:  ['direct', 'ring', 'ring', 'ring']
system knob:  ['direct', 'ring', 'ring', 'ring']
system knob:  ['direct', 'ring', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['direct', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['direct', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['direct', 'ring', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Ring'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [33.333333333333336, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 5 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 1, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 1, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 33.333333333333336, 50, 50]
system knob:  ['ring', 'direct', 'ring', 'ring']
system knob:  ['ring', 'direct', 'ring', 'ring']
system knob:  ['ring', 'direct', 'ring', 'ring']
system knob:  ['ring', 'direct', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 4, 4, 16], 'bandwidth': [50, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 1, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 6 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 2, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 2, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 50, 100, 100]
system knob:  ['direct', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'ring', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Switch'], 'npus-count': [4, 4, 8, 4], 'bandwidth': [33.333333333333336, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 2, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 7 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 1, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 1, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 6.666666666666667, 50, 100]
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [50, 6.666666666666667, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 1, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 8 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 4, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 4, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 14.285714285714286, 50, 100]
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [100, 14.285714285714286, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 4, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 9 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 50, 50]
system knob:  ['ring', 'ring', 'ring', 'ring']
system knob:  ['ring', 'ring', 'ring', 'ring']
system knob:  ['ring', 'ring', 'ring', 'ring']
system knob:  ['ring', 'ring', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Ring'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [50, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 10 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 2, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 2, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 100, 50, 100]
system knob:  ['direct', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'Switch'], 'npus-count': [8, 4, 16, 4], 'bandwidth': [14.285714285714286, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 2, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 11 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 2, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 2, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 100, 100, 100]
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Switch'], 'npus-count': [8, 16, 4, 16], 'bandwidth': [14.285714285714286, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 2, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 12 DIMENSION:  4
Step: 0
REWARD FORMULATION:  runtime*cost
ENV - step 0 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 4, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 4, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [6.666666666666667, 100, 100, 33.333333333333336]
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [16, 4, 4, 4], 'bandwidth': [6.666666666666667, 100, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 4, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  16 <= 1024
constraint satisfied
GENERATING WORKLOAD...
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000} {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus_count': [16, 4, 4, 4], 'bandwidth': [6.666666666666667, 100, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'dp': 2, 'pp': 4, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - self.exe_path, network, system, workload_file:  /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_8_gpt3_175b.json
OUT:  b'SCRIPT DIR: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: TRUE\nSH MEMORY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:35.893] [workload] [critical] workload file: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.0.et does not exist\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: TRUE
SH MEMORY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-11-19 03:25:35.893] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:35.893] [workload] [critical] workload file: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.0.et does not exist
done script

MAX_PEAK_MEM BEFORE MEMORY CAPACITY:  12543590400.0
MAX_CYCLES:  0
MAX_PEAK_MEM:  12543590400.0
NETWORK_COST:  0
AVERAGE MAX_CYCLES ARRAY:  [0]
AVERAGE MAX_PEAK_MEM ARRAY:  [12543590400.0]
AVERAGE NETWORK_COST ARRAY:  [0]
------------------------------------------------------------------
AVERAGE MAX_CYCLES:  0.0
AVERAGE MAX_PEAK_MEM:  12543590400.0
AVERAGE MAX_CYCLES ARRAY:  [0]
AVERAGE MAX_PEAK_MEM ARRAY:  [12543590400.0]
------------------------------------------------------------------
Calculating reward...
['0.e+00' '1.25435904e+10']
observations:  ['0.e+00' '1.25435904e+10']
reward:  -inf
DIMENSION:  4
0 13 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 2, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 2, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 14.285714285714286, 100]
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 8, 8, 4], 'bandwidth': [100, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 2, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  64 <= 1024
constraint satisfied
ENV - SWITCH topology[0] constraint violated
DIMENSION:  4
0 14 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 1, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 1, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 6.666666666666667, 14.285714285714286, 33.333333333333336]
system knob:  ['ring', 'direct', 'direct', 'direct']
system knob:  ['ring', 'direct', 'direct', 'direct']
system knob:  ['ring', 'direct', 'direct', 'direct']
system knob:  ['ring', 'direct', 'direct', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 16, 8, 4], 'bandwidth': [50, 6.666666666666667, 14.285714285714286, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 1, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 15 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 1, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 1, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 33.333333333333336, 6.666666666666667]
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 4, 16], 'bandwidth': [100, 50, 33.333333333333336, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 1, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 16 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 1, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 1, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 100, 14.285714285714286]
system knob:  ['ring', 'ring', 'halvingDoubling', 'direct']
system knob:  ['ring', 'ring', 'halvingDoubling', 'direct']
system knob:  ['ring', 'ring', 'halvingDoubling', 'direct']
system knob:  ['ring', 'ring', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [8, 4, 16, 8], 'bandwidth': [50, 50, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 1, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 17 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 1, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 1, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 50, 100]
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus-count': [8, 4, 4, 16], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 1, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 18 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 100, 33.333333333333336]
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 8, 4], 'bandwidth': [100, 50, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 19 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 1, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 1, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 6.666666666666667, 50]
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [4, 4, 16, 16], 'bandwidth': [50, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 1, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 20 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 4, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 4, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 6.666666666666667, 100]
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 16, 16, 16], 'bandwidth': [100, 100, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 4, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 21 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 50, 6.666666666666667]
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [16, 8, 8, 16], 'bandwidth': [100, 50, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 22 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 2, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 2, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 50, 50]
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 4, 16, 16], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 2, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 23 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 4, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 4, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 100, 50]
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Ring'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [50, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 4, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 24 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 4, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 4, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 100, 6.666666666666667, 100]
system knob:  ['direct', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 8, 16, 16], 'bandwidth': [14.285714285714286, 100, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 4, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 25 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 2, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 2, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 14.285714285714286, 100]
system knob:  ['ring', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['ring', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['ring', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['ring', 'halvingDoubling', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 8, 8, 16], 'bandwidth': [50, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 2, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 26 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 4, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 4, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 100, 6.666666666666667]
system knob:  ['ring', 'ring', 'halvingDoubling', 'direct']
system knob:  ['ring', 'ring', 'halvingDoubling', 'direct']
system knob:  ['ring', 'ring', 'halvingDoubling', 'direct']
system knob:  ['ring', 'ring', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [50, 50, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 4, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 27 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 4, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 4, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 100, 100, 50]
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Ring'], 'npus-count': [8, 16, 16, 4], 'bandwidth': [14.285714285714286, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 4, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 28 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 14.285714285714286, 100, 100]
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 8, 4, 16], 'bandwidth': [100, 14.285714285714286, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 29 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 4, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 4, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 33.333333333333336, 50, 100]
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [16, 4, 8, 4], 'bandwidth': [50, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 4, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 30 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 50, 33.333333333333336, 14.285714285714286]
system knob:  ['direct', 'ring', 'direct', 'direct']
system knob:  ['direct', 'ring', 'direct', 'direct']
system knob:  ['direct', 'ring', 'direct', 'direct']
system knob:  ['direct', 'ring', 'direct', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [33.333333333333336, 50, 33.333333333333336, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 31 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 2, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 2, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 14.285714285714286, 100]
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [8, 16, 8, 16], 'bandwidth': [100, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 2, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 32 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 2, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 2, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 50, 14.285714285714286, 100]
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [14.285714285714286, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 2, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 33 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 1, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 1, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 14.285714285714286, 100, 14.285714285714286]
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 16, 8], 'bandwidth': [100, 14.285714285714286, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 1, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 34 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 4, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 4, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 50, 14.285714285714286]
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [16, 16, 4, 8], 'bandwidth': [100, 50, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 4, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 35 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 1, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 1, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 100, 33.333333333333336]
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [8, 4, 4, 4], 'bandwidth': [100, 50, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 1, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 36 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 1, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 1, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 33.333333333333336, 100, 50]
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Ring'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [100, 33.333333333333336, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 1, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 37 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 4, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 4, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 100, 100]
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Switch'], 'npus-count': [16, 4, 4, 8], 'bandwidth': [100, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 4, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 38 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 1, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 1, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 6.666666666666667, 50]
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [50, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 1, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 39 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 2, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 2, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 33.333333333333336, 50, 33.333333333333336]
system knob:  ['halvingDoubling', 'direct', 'ring', 'direct']
system knob:  ['halvingDoubling', 'direct', 'ring', 'direct']
system knob:  ['halvingDoubling', 'direct', 'ring', 'direct']
system knob:  ['halvingDoubling', 'direct', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [8, 4, 16, 4], 'bandwidth': [100, 33.333333333333336, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 2, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 40 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 4, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 4, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 50, 50]
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [4, 8, 8, 4], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 4, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  524288 <= 1024
constraint not satisfied
DIMENSION:  4
0 41 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 2, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 2, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [6.666666666666667, 50, 100, 14.285714285714286]
system knob:  ['direct', 'ring', 'halvingDoubling', 'direct']
system knob:  ['direct', 'ring', 'halvingDoubling', 'direct']
system knob:  ['direct', 'ring', 'halvingDoubling', 'direct']
system knob:  ['direct', 'ring', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 16, 8], 'bandwidth': [6.666666666666667, 50, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 2, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 42 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 2, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 2, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 33.333333333333336, 50, 50]
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [4, 4, 4, 16], 'bandwidth': [100, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 2, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  131072 <= 1024
constraint not satisfied
DIMENSION:  4
0 43 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 33.333333333333336, 6.666666666666667, 50]
system knob:  ['ring', 'direct', 'direct', 'ring']
system knob:  ['ring', 'direct', 'direct', 'ring']
system knob:  ['ring', 'direct', 'direct', 'ring']
system knob:  ['ring', 'direct', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [16, 4, 16, 16], 'bandwidth': [50, 33.333333333333336, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 44 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 6.666666666666667, 100, 100]
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 16, 8, 4], 'bandwidth': [50, 6.666666666666667, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 45 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 2, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 2, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 6.666666666666667, 100]
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [100, 100, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 2, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 46 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 1, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 1, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 14.285714285714286, 100]
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [16, 4, 8, 16], 'bandwidth': [100, 100, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 1, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 47 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 1, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 1, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 33.333333333333336, 33.333333333333336, 14.285714285714286]
system knob:  ['halvingDoubling', 'direct', 'direct', 'direct']
system knob:  ['halvingDoubling', 'direct', 'direct', 'direct']
system knob:  ['halvingDoubling', 'direct', 'direct', 'direct']
system knob:  ['halvingDoubling', 'direct', 'direct', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 4, 4, 8], 'bandwidth': [100, 33.333333333333336, 33.333333333333336, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 1, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  1024 <= 1024
constraint satisfied
ENV - SWITCH topology[0] constraint violated
DIMENSION:  4
0 48 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [6.666666666666667, 33.333333333333336, 50, 33.333333333333336]
system knob:  ['direct', 'direct', 'ring', 'direct']
system knob:  ['direct', 'direct', 'ring', 'direct']
system knob:  ['direct', 'direct', 'ring', 'direct']
system knob:  ['direct', 'direct', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [16, 4, 4, 4], 'bandwidth': [6.666666666666667, 33.333333333333336, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  1024 <= 1024
constraint satisfied
GENERATING WORKLOAD...
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000} {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus_count': [16, 4, 4, 4], 'bandwidth': [6.666666666666667, 33.333333333333336, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]} {'dp': 2, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - self.exe_path, network, system, workload_file:  /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_8_gpt3_175b.json
OUT:  b'SCRIPT DIR: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: TRUE\nSH MEMORY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64\n[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:36.161] [workload] [critical] workload file: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.0.et does not exist\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: TRUE
SH MEMORY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 16
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 64
[2024-11-19 03:25:36.161] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:36.161] [workload] [critical] workload file: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.0.et does not exist
done script

MAX_PEAK_MEM BEFORE MEMORY CAPACITY:  28185722880.0
Memory constraint violated
DIMENSION:  4
0 49 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 4, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 4, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 50, 50]
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 4, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 50 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 2, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 2, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 33.333333333333336, 100, 14.285714285714286]
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 4, 8, 8], 'bandwidth': [100, 33.333333333333336, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 2, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 51 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 1, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 1, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 14.285714285714286, 100]
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [4, 16, 8, 8], 'bandwidth': [100, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 1, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 52 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 2, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 2, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 33.333333333333336, 100, 14.285714285714286]
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 4, 16, 8], 'bandwidth': [50, 33.333333333333336, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 2, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 53 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 100, 100]
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'Switch'], 'npus-count': [16, 16, 16, 16], 'bandwidth': [100, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  65536 == 1024
constraint not satisfied
DIMENSION:  4
0 54 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 1, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 1, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 50, 6.666666666666667, 50]
system knob:  ['direct', 'ring', 'direct', 'ring']
system knob:  ['direct', 'ring', 'direct', 'ring']
system knob:  ['direct', 'ring', 'direct', 'ring']
system knob:  ['direct', 'ring', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [8, 4, 16, 8], 'bandwidth': [14.285714285714286, 50, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 1, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 55 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 2, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 2, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 50, 33.333333333333336]
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [8, 4, 8, 4], 'bandwidth': [100, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 2, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  64 <= 1024
constraint satisfied
ENV - SWITCH topology[0] constraint violated
DIMENSION:  4
0 56 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 2, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 2, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [6.666666666666667, 50, 14.285714285714286, 100]
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [16, 8, 8, 8], 'bandwidth': [6.666666666666667, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 2, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 57 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 4, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 4, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 50, 100]
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus-count': [16, 4, 4, 16], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 4, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 58 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 1, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 1, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 100, 100, 33.333333333333336]
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 4, 4], 'bandwidth': [33.333333333333336, 100, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 1, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  256 == 1024
constraint not satisfied
DIMENSION:  4
0 59 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 33.333333333333336, 6.666666666666667, 100]
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [8, 4, 16, 4], 'bandwidth': [14.285714285714286, 33.333333333333336, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 60 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 4, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 4, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 33.333333333333336, 100, 100]
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 4, 8, 8], 'bandwidth': [50, 33.333333333333336, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 4, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 61 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 2, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 2, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 50, 6.666666666666667]
system knob:  ['ring', 'halvingDoubling', 'ring', 'direct']
system knob:  ['ring', 'halvingDoubling', 'ring', 'direct']
system knob:  ['ring', 'halvingDoubling', 'ring', 'direct']
system knob:  ['ring', 'halvingDoubling', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [8, 4, 16, 16], 'bandwidth': [50, 100, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 2, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 62 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 1, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 1, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 100, 100]
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Switch'], 'npus-count': [4, 4, 8, 8], 'bandwidth': [50, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 1, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  131072 <= 1024
constraint not satisfied
DIMENSION:  4
0 63 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 2, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 2, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 14.285714285714286, 33.333333333333336, 50]
system knob:  ['ring', 'direct', 'direct', 'ring']
system knob:  ['ring', 'direct', 'direct', 'ring']
system knob:  ['ring', 'direct', 'direct', 'ring']
system knob:  ['ring', 'direct', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [16, 8, 4, 16], 'bandwidth': [50, 14.285714285714286, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 2, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 64 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 1, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 1, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 6.666666666666667, 50, 100]
system knob:  ['direct', 'direct', 'ring', 'halvingDoubling']
system knob:  ['direct', 'direct', 'ring', 'halvingDoubling']
system knob:  ['direct', 'direct', 'ring', 'halvingDoubling']
system knob:  ['direct', 'direct', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [33.333333333333336, 6.666666666666667, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 1, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 65 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 4, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 4, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 50, 6.666666666666667]
system knob:  ['ring', 'halvingDoubling', 'ring', 'direct']
system knob:  ['ring', 'halvingDoubling', 'ring', 'direct']
system knob:  ['ring', 'halvingDoubling', 'ring', 'direct']
system knob:  ['ring', 'halvingDoubling', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 4, 16], 'bandwidth': [50, 100, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 4, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 66 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [6.666666666666667, 14.285714285714286, 100, 14.285714285714286]
system knob:  ['direct', 'direct', 'halvingDoubling', 'direct']
system knob:  ['direct', 'direct', 'halvingDoubling', 'direct']
system knob:  ['direct', 'direct', 'halvingDoubling', 'direct']
system knob:  ['direct', 'direct', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 16, 8], 'bandwidth': [6.666666666666667, 14.285714285714286, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 67 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 2, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 2, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 6.666666666666667, 50]
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
system knob:  ['ring', 'halvingDoubling', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [50, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 2, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 68 DIMENSION:  4
Step: 1
REWARD FORMULATION:  runtime*cost
ENV - step 1 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 2, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 2, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 33.333333333333336, 14.285714285714286, 50]
system knob:  ['ring', 'direct', 'direct', 'ring']
system knob:  ['ring', 'direct', 'direct', 'ring']
system knob:  ['ring', 'direct', 'direct', 'ring']
system knob:  ['ring', 'direct', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [8, 4, 8, 4], 'bandwidth': [50, 33.333333333333336, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 2, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  1024 <= 1024
constraint satisfied
GENERATING WORKLOAD...
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000} {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus_count': [8, 4, 8, 4], 'bandwidth': [50, 33.333333333333336, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]} {'dp': 256, 'pp': 2, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - self.exe_path, network, system, workload_file:  /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_8_gpt3_175b.json
OUT:  b'SCRIPT DIR: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: TRUE\nSH MEMORY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256\n[2024-11-19 03:25:36.385] [workload] [critical] workload file: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.0.et does not exist\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: TRUE
SH MEMORY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.385] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 256
[2024-11-19 03:25:36.385] [workload] [critical] workload file: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.0.et does not exist
done script

MAX_PEAK_MEM BEFORE MEMORY CAPACITY:  18525585408.0
MAX_CYCLES:  0
MAX_PEAK_MEM:  18525585408.0
NETWORK_COST:  0
AVERAGE MAX_CYCLES ARRAY:  [0]
AVERAGE MAX_PEAK_MEM ARRAY:  [18525585408.0]
AVERAGE NETWORK_COST ARRAY:  [0]
------------------------------------------------------------------
AVERAGE MAX_CYCLES:  0.0
AVERAGE MAX_PEAK_MEM:  18525585408.0
AVERAGE MAX_CYCLES ARRAY:  [0]
AVERAGE MAX_PEAK_MEM ARRAY:  [18525585408.0]
------------------------------------------------------------------
Calculating reward...
['0.e+00' '1.8525585408e+10']
observations:  ['0.e+00' '1.8525585408e+10']
reward:  -inf
DIMENSION:  4
0 69 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 4, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 4, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 100, 50]
system knob:  ['ring', 'ring', 'halvingDoubling', 'ring']
system knob:  ['ring', 'ring', 'halvingDoubling', 'ring']
system knob:  ['ring', 'ring', 'halvingDoubling', 'ring']
system knob:  ['ring', 'ring', 'halvingDoubling', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Ring'], 'npus-count': [16, 16, 8, 4], 'bandwidth': [50, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 4, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 70 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 4, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 4, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 50, 100]
system knob:  ['ring', 'ring', 'ring', 'halvingDoubling']
system knob:  ['ring', 'ring', 'ring', 'halvingDoubling']
system knob:  ['ring', 'ring', 'ring', 'halvingDoubling']
system knob:  ['ring', 'ring', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Switch'], 'npus-count': [8, 16, 8, 4], 'bandwidth': [50, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 4, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 71 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 4, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 4, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 33.333333333333336, 100, 100]
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'direct', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [50, 33.333333333333336, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 4, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 72 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 1, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 1, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 100, 50]
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'Ring'], 'npus-count': [16, 4, 16, 16], 'bandwidth': [50, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 1, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 73 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 2, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 2, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 100, 14.285714285714286, 50]
system knob:  ['direct', 'halvingDoubling', 'direct', 'ring']
system knob:  ['direct', 'halvingDoubling', 'direct', 'ring']
system knob:  ['direct', 'halvingDoubling', 'direct', 'ring']
system knob:  ['direct', 'halvingDoubling', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [8, 8, 8, 16], 'bandwidth': [14.285714285714286, 100, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 2, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 74 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [6.666666666666667, 50, 50, 100]
system knob:  ['direct', 'ring', 'ring', 'halvingDoubling']
system knob:  ['direct', 'ring', 'ring', 'halvingDoubling']
system knob:  ['direct', 'ring', 'ring', 'halvingDoubling']
system knob:  ['direct', 'ring', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'Switch'], 'npus-count': [16, 16, 4, 8], 'bandwidth': [6.666666666666667, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 75 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 4, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 4, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 100, 100, 100]
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Switch'], 'npus-count': [8, 16, 8, 16], 'bandwidth': [14.285714285714286, 100, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 4, 'sp': 4, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 76 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 50, 33.333333333333336]
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
system knob:  ['halvingDoubling', 'ring', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [4, 4, 4, 4], 'bandwidth': [100, 50, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  256 == 1024
constraint not satisfied
DIMENSION:  4
0 77 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 33.333333333333336, 33.333333333333336]
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [4, 8, 4, 4], 'bandwidth': [100, 50, 33.333333333333336, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 78 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 6.666666666666667, 6.666666666666667]
system knob:  ['ring', 'halvingDoubling', 'direct', 'direct']
system knob:  ['ring', 'halvingDoubling', 'direct', 'direct']
system knob:  ['ring', 'halvingDoubling', 'direct', 'direct']
system knob:  ['ring', 'halvingDoubling', 'direct', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'direct', 'direct'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'direct', 'direct'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'direct', 'direct'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 8, 16, 16], 'bandwidth': [50, 100, 6.666666666666667, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 79 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 2, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 2, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 100, 6.666666666666667]
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 4, 16], 'bandwidth': [100, 50, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 2, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 80 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 1, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 1, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 50, 6.666666666666667]
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'direct']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'direct']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'direct']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [8, 4, 16, 16], 'bandwidth': [100, 100, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 1, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 81 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 2, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 2, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 100, 6.666666666666667, 100]
system knob:  ['direct', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'direct', 'halvingDoubling']
system knob:  ['direct', 'halvingDoubling', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'FullyConnected', 'Switch'], 'npus-count': [8, 8, 16, 4], 'bandwidth': [14.285714285714286, 100, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 2, 'sp': 2, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 82 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 2, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 2, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 33.333333333333336, 50, 100]
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
system knob:  ['ring', 'direct', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [16, 4, 16, 8], 'bandwidth': [50, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 2, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 83 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 14.285714285714286, 50, 33.333333333333336]
system knob:  ['ring', 'direct', 'ring', 'direct']
system knob:  ['ring', 'direct', 'ring', 'direct']
system knob:  ['ring', 'direct', 'ring', 'direct']
system knob:  ['ring', 'direct', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [50, 14.285714285714286, 50, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 84 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 4, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 4, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 50, 100]
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus-count': [8, 4, 4, 8], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 4, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  4096 <= 1024
constraint not satisfied
DIMENSION:  4
0 85 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 1, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 1, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 14.285714285714286, 100, 100]
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 8, 8, 8], 'bandwidth': [100, 14.285714285714286, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 1, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 86 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 33.333333333333336, 33.333333333333336]
system knob:  ['ring', 'ring', 'direct', 'direct']
system knob:  ['ring', 'ring', 'direct', 'direct']
system knob:  ['ring', 'ring', 'direct', 'direct']
system knob:  ['ring', 'ring', 'direct', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 4, 4, 4], 'bandwidth': [50, 50, 33.333333333333336, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 87 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 2, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 2, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 50, 6.666666666666667]
system knob:  ['ring', 'ring', 'ring', 'direct']
system knob:  ['ring', 'ring', 'ring', 'direct']
system knob:  ['ring', 'ring', 'ring', 'direct']
system knob:  ['ring', 'ring', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [8, 8, 16, 16], 'bandwidth': [50, 50, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 2, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 88 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 1, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 1, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 100, 6.666666666666667]
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['ring', 'halvingDoubling', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [16, 16, 4, 16], 'bandwidth': [50, 100, 100, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 1, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 89 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [6.666666666666667, 50, 14.285714285714286, 100]
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
system knob:  ['direct', 'ring', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'FullyConnected', 'Switch'], 'npus-count': [16, 8, 8, 8], 'bandwidth': [6.666666666666667, 50, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 90 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 14.285714285714286, 14.285714285714286, 14.285714285714286]
system knob:  ['direct', 'direct', 'direct', 'direct']
system knob:  ['direct', 'direct', 'direct', 'direct']
system knob:  ['direct', 'direct', 'direct', 'direct']
system knob:  ['direct', 'direct', 'direct', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 8, 8, 8], 'bandwidth': [14.285714285714286, 14.285714285714286, 14.285714285714286, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 91 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 4, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 4, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 6.666666666666667, 50, 50]
system knob:  ['ring', 'direct', 'ring', 'ring']
system knob:  ['ring', 'direct', 'ring', 'ring']
system knob:  ['ring', 'direct', 'ring', 'ring']
system knob:  ['ring', 'direct', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'direct', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 16, 8, 16], 'bandwidth': [50, 6.666666666666667, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 4, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 92 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 50, 100]
system knob:  ['halvingDoubling', 'ring', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Ring', 'Switch'], 'npus-count': [16, 4, 4, 16], 'bandwidth': [100, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 93 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 50, 50]
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Ring'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [100, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 94 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 6.666666666666667, 50]
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'FullyConnected', 'Ring'], 'npus-count': [16, 4, 16, 8], 'bandwidth': [100, 100, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 95 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 14.285714285714286, 50, 6.666666666666667]
system knob:  ['direct', 'direct', 'ring', 'direct']
system knob:  ['direct', 'direct', 'ring', 'direct']
system knob:  ['direct', 'direct', 'ring', 'direct']
system knob:  ['direct', 'direct', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'FullyConnected'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [33.333333333333336, 14.285714285714286, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 4, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 96 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 14.285714285714286, 100, 100]
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [16, 8, 8, 4], 'bandwidth': [100, 14.285714285714286, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 97 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 2, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 2, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 6.666666666666667, 14.285714285714286, 100]
system knob:  ['ring', 'direct', 'direct', 'halvingDoubling']
system knob:  ['ring', 'direct', 'direct', 'halvingDoubling']
system knob:  ['ring', 'direct', 'direct', 'halvingDoubling']
system knob:  ['ring', 'direct', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [4, 16, 8, 16], 'bandwidth': [50, 6.666666666666667, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 2, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 98 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 50, 50, 14.285714285714286]
system knob:  ['direct', 'ring', 'ring', 'direct']
system knob:  ['direct', 'ring', 'ring', 'direct']
system knob:  ['direct', 'ring', 'ring', 'direct']
system knob:  ['direct', 'ring', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'ring', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [4, 4, 4, 8], 'bandwidth': [33.333333333333336, 50, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 2, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 99 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 1, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 1, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 100, 100, 50]
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'ring']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'Ring'], 'npus-count': [8, 4, 16, 16], 'bandwidth': [14.285714285714286, 100, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 1, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 100 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 2, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 2, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 50, 100, 100]
system knob:  ['direct', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'ring', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Switch'], 'npus-count': [4, 16, 8, 4], 'bandwidth': [33.333333333333336, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 2, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 101 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 50, 100]
system knob:  ['ring', 'ring', 'ring', 'halvingDoubling']
system knob:  ['ring', 'ring', 'ring', 'halvingDoubling']
system knob:  ['ring', 'ring', 'ring', 'halvingDoubling']
system knob:  ['ring', 'ring', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Switch'], 'npus-count': [8, 4, 4, 16], 'bandwidth': [50, 50, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 102 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 33.333333333333336, 6.666666666666667, 100]
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [8, 4, 16, 16], 'bandwidth': [14.285714285714286, 33.333333333333336, 6.666666666666667, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 103 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 33.333333333333336, 50, 100]
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 4, 16, 16], 'bandwidth': [100, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 104 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [6.666666666666667, 50, 100, 50]
system knob:  ['direct', 'ring', 'halvingDoubling', 'ring']
system knob:  ['direct', 'ring', 'halvingDoubling', 'ring']
system knob:  ['direct', 'ring', 'halvingDoubling', 'ring']
system knob:  ['direct', 'ring', 'halvingDoubling', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['direct', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Ring', 'Switch', 'Ring'], 'npus-count': [16, 8, 8, 8], 'bandwidth': [6.666666666666667, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 105 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 100, 50, 14.285714285714286]
system knob:  ['direct', 'halvingDoubling', 'ring', 'direct']
system knob:  ['direct', 'halvingDoubling', 'ring', 'direct']
system knob:  ['direct', 'halvingDoubling', 'ring', 'direct']
system knob:  ['direct', 'halvingDoubling', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'Ring', 'FullyConnected'], 'npus-count': [4, 4, 16, 8], 'bandwidth': [33.333333333333336, 100, 50, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 106 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 1, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 1, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 100, 50]
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Ring'], 'npus-count': [16, 16, 8, 8], 'bandwidth': [100, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 1, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 107 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 32, 'pp': 1, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 32, 'pp': 1, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 50, 50]
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
system knob:  ['ring', 'halvingDoubling', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Ring'], 'npus-count': [4, 16, 8, 4], 'bandwidth': [50, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 32, 'pp': 1, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 108 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 50, 50]
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Ring'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [100, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 4, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 109 DIMENSION:  4
Step: 2
REWARD FORMULATION:  runtime*cost
ENV - step 2 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 100, 100, 14.285714285714286]
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['direct', 'halvingDoubling', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [8, 4, 4, 8], 'bandwidth': [14.285714285714286, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  256 <= 1024
constraint satisfied
GENERATING WORKLOAD...
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000} {'topology': ['FullyConnected', 'Switch', 'Switch', 'FullyConnected'], 'npus_count': [8, 4, 4, 8], 'bandwidth': [14.285714285714286, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]} {'dp': 4, 'pp': 1, 'sp': 64, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - self.exe_path, network, system, workload_file:  /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_8_gpt3_175b.json
OUT:  b'SCRIPT DIR: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: TRUE\nSH MEMORY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-11-19 03:25:36.672] [workload] [critical] workload file: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.0.et does not exist\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: TRUE
SH MEMORY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.672] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-11-19 03:25:36.672] [workload] [critical] workload file: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.0.et does not exist
done script

MAX_PEAK_MEM BEFORE MEMORY CAPACITY:  16408117248.0
MAX_CYCLES:  0
MAX_PEAK_MEM:  16408117248.0
NETWORK_COST:  0
AVERAGE MAX_CYCLES ARRAY:  [0]
AVERAGE MAX_PEAK_MEM ARRAY:  [16408117248.0]
AVERAGE NETWORK_COST ARRAY:  [0]
------------------------------------------------------------------
AVERAGE MAX_CYCLES:  0.0
AVERAGE MAX_PEAK_MEM:  16408117248.0
AVERAGE MAX_CYCLES ARRAY:  [0]
AVERAGE MAX_PEAK_MEM ARRAY:  [16408117248.0]
------------------------------------------------------------------
Calculating reward...
['0.e+00' '1.6408117248e+10']
observations:  ['0.e+00' '1.6408117248e+10']
reward:  -inf
DIMENSION:  4
0 110 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 2, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 2, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 6.666666666666667, 6.666666666666667, 50]
system knob:  ['halvingDoubling', 'direct', 'direct', 'ring']
system knob:  ['halvingDoubling', 'direct', 'direct', 'ring']
system knob:  ['halvingDoubling', 'direct', 'direct', 'ring']
system knob:  ['halvingDoubling', 'direct', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [8, 16, 16, 8], 'bandwidth': [100, 6.666666666666667, 6.666666666666667, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 2, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 111 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 4, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 4, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 100, 100]
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Switch'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [100, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 4, 'sp': 32, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 112 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 1, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 1, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 100, 100]
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Switch'], 'npus-count': [8, 4, 16, 4], 'bandwidth': [50, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 1, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 113 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 6.666666666666667, 50, 50]
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [16, 16, 8, 4], 'bandwidth': [100, 6.666666666666667, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 1, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 114 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 2, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 2, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 50, 100]
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Switch'], 'npus-count': [4, 8, 16, 4], 'bandwidth': [100, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 2, 'sp': 128, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 115 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 2, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 2, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 50, 6.666666666666667]
system knob:  ['ring', 'ring', 'ring', 'direct']
system knob:  ['ring', 'ring', 'ring', 'direct']
system knob:  ['ring', 'ring', 'ring', 'direct']
system knob:  ['ring', 'ring', 'ring', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'direct'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'direct'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'direct'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'FullyConnected'], 'npus-count': [8, 8, 4, 16], 'bandwidth': [50, 50, 50, 6.666666666666667], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 2, 'sp': 8, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 116 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 4, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 4, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 14.285714285714286, 50, 50]
system knob:  ['direct', 'direct', 'ring', 'ring']
system knob:  ['direct', 'direct', 'ring', 'ring']
system knob:  ['direct', 'direct', 'ring', 'ring']
system knob:  ['direct', 'direct', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['direct', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['direct', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['direct', 'direct', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [4, 8, 16, 16], 'bandwidth': [33.333333333333336, 14.285714285714286, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 4, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 117 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 2, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 2, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 50, 50]
system knob:  ['ring', 'ring', 'ring', 'ring']
system knob:  ['ring', 'ring', 'ring', 'ring']
system knob:  ['ring', 'ring', 'ring', 'ring']
system knob:  ['ring', 'ring', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'ring', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'ring', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'ring', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Ring', 'Ring'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [50, 50, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 2, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 118 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 100, 33.333333333333336]
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'FullyConnected'], 'npus-count': [16, 8, 16, 4], 'bandwidth': [100, 50, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 119 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [6.666666666666667, 14.285714285714286, 14.285714285714286, 100]
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [16, 8, 8, 16], 'bandwidth': [6.666666666666667, 14.285714285714286, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 1, 'sp': 512, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 120 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 1, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 1, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 100, 100]
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Switch'], 'npus-count': [8, 16, 4, 8], 'bandwidth': [50, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 1, 'sp': 8, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 121 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 33.333333333333336, 50, 100]
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Switch'], 'npus-count': [4, 4, 8, 8], 'bandwidth': [100, 33.333333333333336, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  65536 <= 1024
constraint not satisfied
DIMENSION:  4
0 122 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 50, 50]
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
system knob:  ['halvingDoubling', 'halvingDoubling', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'Ring', 'Ring'], 'npus-count': [4, 16, 16, 8], 'bandwidth': [100, 100, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 2, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 123 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 4, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 4, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 6.666666666666667, 14.285714285714286, 50]
system knob:  ['halvingDoubling', 'direct', 'direct', 'ring']
system knob:  ['halvingDoubling', 'direct', 'direct', 'ring']
system knob:  ['halvingDoubling', 'direct', 'direct', 'ring']
system knob:  ['halvingDoubling', 'direct', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'FullyConnected', 'Ring'], 'npus-count': [4, 16, 8, 8], 'bandwidth': [100, 6.666666666666667, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 4, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 124 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 2, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 2, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 33.333333333333336, 100, 100]
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 4, 8, 16], 'bandwidth': [100, 33.333333333333336, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 2, 'sp': 2, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 125 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 4, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 4, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 100, 50]
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'ring']
system knob:  ['halvingDoubling', 'ring', 'halvingDoubling', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'halvingDoubling', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'Switch', 'Ring'], 'npus-count': [8, 16, 16, 4], 'bandwidth': [100, 50, 100, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 4, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  8192 == 1024
constraint not satisfied
DIMENSION:  4
0 126 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 4, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 4, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 33.333333333333336, 100, 100]
system knob:  ['direct', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'direct', 'halvingDoubling', 'halvingDoubling']
system knob:  ['direct', 'direct', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'Switch'], 'npus-count': [8, 4, 8, 8], 'bandwidth': [14.285714285714286, 33.333333333333336, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 4, 'sp': 1, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 127 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 4, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 4, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 14.285714285714286, 14.285714285714286, 100]
system knob:  ['ring', 'direct', 'direct', 'halvingDoubling']
system knob:  ['ring', 'direct', 'direct', 'halvingDoubling']
system knob:  ['ring', 'direct', 'direct', 'halvingDoubling']
system knob:  ['ring', 'direct', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [4, 8, 8, 16], 'bandwidth': [50, 14.285714285714286, 14.285714285714286, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 4, 'sp': 256, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 128 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 512, 'pp': 1, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 512, 'pp': 1, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 100, 100]
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
system knob:  ['ring', 'ring', 'halvingDoubling', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'ring', 'halvingDoubling', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'Switch', 'Switch'], 'npus-count': [4, 4, 16, 16], 'bandwidth': [50, 50, 100, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 512, 'pp': 1, 'sp': 16, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 129 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 8, 'pp': 2, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 8, 'pp': 2, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 6.666666666666667, 100, 33.333333333333336]
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 16, 8, 4], 'bandwidth': [50, 6.666666666666667, 100, 33.333333333333336], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 8, 'pp': 2, 'sp': 512, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 130 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 14.285714285714286, 14.285714285714286]
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
system knob:  ['halvingDoubling', 'ring', 'direct', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'FullyConnected'], 'npus-count': [8, 8, 8, 8], 'bandwidth': [100, 50, 14.285714285714286, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  4096 == 1024
constraint not satisfied
DIMENSION:  4
0 131 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 1, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 1, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 50, 33.333333333333336, 50]
system knob:  ['halvingDoubling', 'ring', 'direct', 'ring']
system knob:  ['halvingDoubling', 'ring', 'direct', 'ring']
system knob:  ['halvingDoubling', 'ring', 'direct', 'ring']
system knob:  ['halvingDoubling', 'ring', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'ring', 'direct', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'ring', 'direct', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'ring', 'direct', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'ring', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [4, 16, 4, 8], 'bandwidth': [100, 50, 33.333333333333336, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 1, 'pp': 4, 'sp': 32, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 132 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 4, 'pp': 4, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 4, 'pp': 4, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 50, 14.285714285714286, 50]
system knob:  ['ring', 'ring', 'direct', 'ring']
system knob:  ['ring', 'ring', 'direct', 'ring']
system knob:  ['ring', 'ring', 'direct', 'ring']
system knob:  ['ring', 'ring', 'direct', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'ring', 'direct', 'ring'], 'all-gather-implementation': ['ring', 'ring', 'direct', 'ring'], 'reduce-scatter-implementation': ['ring', 'ring', 'direct', 'ring'], 'all-to-all-implementation': ['ring', 'ring', 'direct', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Ring', 'FullyConnected', 'Ring'], 'npus-count': [16, 16, 8, 16], 'bandwidth': [50, 50, 14.285714285714286, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 4, 'pp': 4, 'sp': 256, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  32768 == 1024
constraint not satisfied
DIMENSION:  4
0 133 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 64, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 64, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 100, 100, 14.285714285714286]
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct']
system knob:  ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['halvingDoubling', 'halvingDoubling', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'Switch', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 16, 8], 'bandwidth': [100, 100, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 64, 'pp': 4, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 134 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 2, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 2, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 14.285714285714286, 33.333333333333336, 100]
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
system knob:  ['direct', 'direct', 'direct', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'all-gather-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'reduce-scatter-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'all-to-all-implementation': ['direct', 'direct', 'direct', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'FullyConnected', 'Switch'], 'npus-count': [4, 8, 4, 16], 'bandwidth': [33.333333333333336, 14.285714285714286, 33.333333333333336, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 2, 'sp': 16, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  2048 == 1024
constraint not satisfied
DIMENSION:  4
0 135 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 1, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 1, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 100, 50, 100]
system knob:  ['ring', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['ring', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['ring', 'halvingDoubling', 'ring', 'halvingDoubling']
system knob:  ['ring', 'halvingDoubling', 'ring', 'halvingDoubling']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-gather-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'reduce-scatter-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'all-to-all-implementation': ['ring', 'halvingDoubling', 'ring', 'halvingDoubling'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'Switch', 'Ring', 'Switch'], 'npus-count': [8, 8, 16, 16], 'bandwidth': [50, 100, 50, 100], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 128, 'pp': 1, 'sp': 128, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  16384 == 1024
constraint not satisfied
DIMENSION:  4
0 136 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 2, 'pp': 2, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 2, 'pp': 2, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [50, 33.333333333333336, 100, 14.285714285714286]
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
system knob:  ['ring', 'direct', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['ring', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Ring', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [4, 4, 4, 8], 'bandwidth': [50, 33.333333333333336, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 2, 'pp': 2, 'sp': 4, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  512 == 1024
constraint not satisfied
DIMENSION:  4
0 137 DIMENSION:  4
Step: 3
REWARD FORMULATION:  runtime*cost
ENV - step 3 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 256, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 256, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [14.285714285714286, 33.333333333333336, 100, 14.285714285714286]
system knob:  ['direct', 'direct', 'halvingDoubling', 'direct']
system knob:  ['direct', 'direct', 'halvingDoubling', 'direct']
system knob:  ['direct', 'direct', 'halvingDoubling', 'direct']
system knob:  ['direct', 'direct', 'halvingDoubling', 'direct']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus-count': [8, 4, 4, 8], 'bandwidth': [14.285714285714286, 33.333333333333336, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 256, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  1024 <= 1024
constraint satisfied
GENERATING WORKLOAD...
Running simulation...
all configs:  {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'all-gather-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'reduce-scatter-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'all-to-all-implementation': ['direct', 'direct', 'halvingDoubling', 'direct'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000} {'topology': ['FullyConnected', 'FullyConnected', 'Switch', 'FullyConnected'], 'npus_count': [8, 4, 4, 8], 'bandwidth': [14.285714285714286, 33.333333333333336, 100, 14.285714285714286], 'latency': [700.0, 700.0, 700.0, 700.0]} {'dp': 256, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - self.exe_path, network, system, workload_file:  /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/run.sh /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload_cfg_8_gpt3_175b.json
OUT:  b'SCRIPT DIR: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example\nSH BINARY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware\nSH NETWORK: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml\nSH SYSTEM: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json\nSH WORKLOAD: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated\nSH GENERATE: TRUE\nSH MEMORY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json\nRUN COMMAND /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32\n[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128\n[2024-11-19 03:25:36.886] [workload] [critical] workload file: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.0.et does not exist\ndone script\n'
------------------------------------------------------------------
standard output: 
SCRIPT DIR: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example
SH BINARY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware
SH NETWORK: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml
SH SYSTEM: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json
SH WORKLOAD: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated
SH GENERATE: TRUE
SH MEMORY: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json
RUN COMMAND /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_archgym_public/astra-sim/build/astra_analytical/build/bin/AstraSim_Analytical_Congestion_Aware --workload-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated --system-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/system.json --network-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/network.yml --remote-memory-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/memory.json --comm-group-configuration=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.json --log-path=/home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/log.log
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 1
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 8
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 4 index in ring: 0total nodes in ring: 32
[2024-11-19 03:25:36.886] [topology::RingTopology] [info] ring of node 0, id: 0 dimension: local total nodes in ring: 8 index in ring: 0total nodes in ring: 128
[2024-11-19 03:25:36.886] [workload] [critical] workload file: /home/archgym/workspace/aditi_jared/11-19/oss-arch-gym/sims/AstraSim/astrasim_220_example/workload-et/generated.0.et does not exist
done script

MAX_PEAK_MEM BEFORE MEMORY CAPACITY:  16408117248.0
MAX_CYCLES:  0
MAX_PEAK_MEM:  16408117248.0
NETWORK_COST:  0
AVERAGE MAX_CYCLES ARRAY:  [0]
AVERAGE MAX_PEAK_MEM ARRAY:  [16408117248.0]
AVERAGE NETWORK_COST ARRAY:  [0]
------------------------------------------------------------------
AVERAGE MAX_CYCLES:  0.0
AVERAGE MAX_PEAK_MEM:  16408117248.0
AVERAGE MAX_CYCLES ARRAY:  [0]
AVERAGE MAX_PEAK_MEM ARRAY:  [16408117248.0]
------------------------------------------------------------------
Calculating reward...
['0.e+00' '1.6408117248e+10']
observations:  ['0.e+00' '1.6408117248e+10']
reward:  -inf
DIMENSION:  4
0 138 DIMENSION:  4
Step: 4
REWARD FORMULATION:  runtime*cost
ENV - step 4 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 16, 'pp': 1, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 16, 'pp': 1, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [100, 33.333333333333336, 50, 50]
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
system knob:  ['halvingDoubling', 'direct', 'ring', 'ring']
DERIVED action_dict:  {'system': {'scheduling-policy': 'LIFO', 'endpoint-delay': 10, 'active-chunks-per-dimension': 1, 'preferred-dataset-splits': 4, 'all-reduce-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'all-gather-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'reduce-scatter-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'all-to-all-implementation': ['halvingDoubling', 'direct', 'ring', 'ring'], 'collective-optimization': 'baseline', 'boost-mode': 0, 'roofline-enabled': 1, 'peak-perf': 10, 'local-mem-bw': 50, 'memory-capacity': 24000000000}, 'network': {'topology': ['Switch', 'FullyConnected', 'Ring', 'Ring'], 'npus-count': [4, 4, 4, 16], 'bandwidth': [100, 33.333333333333336, 50, 50], 'latency': [700.0, 700.0, 700.0, 700.0]}, 'workload': {'dp': 16, 'pp': 1, 'sp': 64, 'weight_sharded': 0, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}}
!!!!!! CONSTRAINT:  product network npus-count == num workload num_npus
EVALUABLE:  1024 == 1024
constraint satisfied
!!!!!! CONSTRAINT:  mult workload dp workload sp workload pp <= num workload num_npus
EVALUABLE:  1024 <= 1024
constraint satisfied
ENV - SWITCH topology[0] constraint violated
DIMENSION:  4
0 139 DIMENSION:  4
Step: 4
REWARD FORMULATION:  runtime*cost
ENV - step 4 0th workload: workload_cfg_8_gpt3_175b.json
ENV - PARSE ACTION_DICT before:  {'dp': 128, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
ENV - PARSE ACTION_DICT after:  {'dp': 128, 'pp': 4, 'sp': 1, 'weight_sharded': 1, 'num_npus': 1024, 'din': 12288, 'dout': 12288, 'dff': 49152, 'dmodel': 12288, 'batch': 2048, 'seq': 2048, 'head': 96, 'num_stacks': 4}
network bandwidth:  [33.333333333333336, 6.666666666666667, 50, 14.285714285714286]
system knob:  ['direct', 'direct', 'ring', 'direct']
system knob:  ['direct', 'direct', 'ring', 'direct']
system knob:  ['direct', 'direct', 'ring', 'direct']
system knob:  ['direct', 'direct', 'ring', 'direct']
DERIVED action_dict:  